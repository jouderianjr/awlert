(function(){
	'use strict';
	
	angular.module('awlert', []);
})();
(function () {
	'use strict';

	angular.module('awlert')
	.constant('AWLERT_TYPES', {
		"ERROR": 'assertive-bg',
		"SUCCESS": 'balanced-bg',
		"NEUTRAL": 'positive-bg',
		"CUSTOM":  ''
	});
})();
(function () {
	'use strict';

	angular.module('awlert')
	.directive('awLert', AwesomeAlert);

	AwesomeAlert.$inject = ['$timeout'];

	function AwesomeAlert($timeout){
		var transformDuration = 600;
		var scope;
		var element;

		function _link(scope, element){
			scope.$parent.remove = _remove;			
			
			init();

			function init(){
				element.addClass(scope.type);

				element.bind('click', _clickHandler);

				$timeout(function(){
					element.addClass('enter');

					if(scope.duration == -1) 
						return;
					else
						_remove();

				}, 30);				
			}

			function _clickHandler(){
				scope.$emit('awlert:click', scope);
			}

			function _remove(){
				$timeout(function(){

					element.removeClass('enter');									
					
					$timeout(function(){

						element.remove();
						scope.$destroy();

					}, transformDuration);							

				}, scope.duration || 3000);			
			}

		}


		return {
			template: '<div class="awlert">'+
									'<div class="content">'+
									'{{message}}'+
									'</div>'+
								'</div>',
			replace: 'true',
			restrict: 'E',
			scope: true, 
			link: _link
		}
	}

})();
(function (){
	'use strict';

	angular.module('awlert')
	.factory('AwlertProvider', AwlertProvider);

	AwlertProvider.$inject = ['$compile', '$document', '$rootScope', 'AWLERT_TYPES'];
	
	function AwlertProvider($compile, $document, $rootScope, AWLERT_TYPES){

		function _neutral(message, duration){
			return _show(message, duration, AWLERT_TYPES.NEUTRAL);
		}		

		function _error(message, duration){
			return _show(message, duration, AWLERT_TYPES.ERROR);
		}

		function _success(message, duration){
			return _show(message, duration, AWLERT_TYPES.SUCCESS);			
		}

		function _show(message, duration, type){
			var scope = $rootScope.$new(true);

			angular.extend(scope, {
				message: message,
				duration: duration,
				type: type
			});

			_appendElement(scope);

			return scope;
		}
	
		function _appendElement(scope){
			var element = $compile('<aw-lert></aw-lert>')(scope);
			$document[0].body.appendChild(element[0]);				
		}

		return {
			error: _error,
			success: _success,
			neutral: _neutral
		};
	}

})();